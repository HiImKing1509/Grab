use Grab
go

set dateformat mdy
select * from HISTORY
join GRAB_BIKE on HISTORY.SERVICE_ID = GRAB_BIKE.GRAB_BIKE_ID 
where HISTORY.SERVICE_ID like 'GB%' and GRAB_BIKE.GRAB_BIKE_ID_PROVINCE = HISTORY.PROVINCE_ID order by HISTORY.SERVICE_TIME desc

truncate table HISTORY

INSERT INTO HISTORY (SERVICE_ID, CUSTOMER_ID, PROVINCE_ID, LOCATION_START, LOCATION_END, DISTANCE, SERVICE_TIME, SERVICE_EVALUATE_SCORE) VALUES
	('GC01', '0796616454', 10, N'Hà Nội', N'SG', 20.0, '12-18-2022 15:45:21 PM', 2),
	('GC02', '0796616454', 2, N'Hà Nội', N'SG', 25.0, '12-19-2022 15:45:21 PM', 3),
	('GC03', '0796616454', 6, N'Hà Nội', N'SG', 260.0, '12-20-2022 15:45:21 PM', 1),
	('GC04', '0796616454', 8, N'Hà Nội', N'SG', 370.9, '12-21-2022 15:45:21 PM', 5),
	('GC05', '0796616454', 10, N'Hà Nội', N'SG', 50.0, '12-22-2022 15:45:21 PM', 5),
	('GB01', '0796616454', 79, N'Hà Nội', N'SG',52.45, '12-25-2022 15:45:21 PM', 2);

SELECT DATEADD(minute, 20, '12-18-2022 15:45:21') AS DateAdd;

DECLARE @date1 DATE, @date2 VARCHAR(20);
SET @date1='2022-01-01';
SET @date2=GETDATE();
IF @date1=@date2
SELECT 'equal date'
ELSE
IF @date1<@date2 SELECT 'date2 is greater'
ELSE SELECT 'date1 is greater';